(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/component/wm-poster"],{1367:function(t,e,a){"use strict";a.r(e);var r=a("fcca"),c=a("85f0");for(var n in c)"default"!==n&&function(t){a.d(e,t,function(){return c[t]})}(n);var i=a("2877"),o=Object(i["a"])(c["default"],r["a"],r["b"],!1,null,null,null);e["default"]=o.exports},"85f0":function(t,e,a){"use strict";a.r(e);var r=a("a37b"),c=a.n(r);for(var n in r)"default"!==n&&function(t){a.d(e,t,function(){return r[t]})}(n);e["default"]=c.a},a37b:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,c=n(a("a34a"));function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e,a,r,c,n,i){try{var o=t[n](i),l=o.value}catch(s){return void a(s)}o.done?e(l):Promise.resolve(l).then(r,c)}function o(t){return function(){var e=this,a=arguments;return new Promise(function(r,c){var n=t.apply(e,a);function o(t){i(n,r,c,o,l,"next",t)}function l(t){i(n,r,c,o,l,"throw",t)}o(void 0)})}}var l={name:"wm-poster",props:{CanvasID:{Type:String,default:"PosterCanvas"},imgSrc:{Type:String,default:""},avatarUrl:{Type:String,default:""},QrSrc:{Type:String,default:""},Title:{Type:String,default:""},TitleColor:{Type:String,default:"#333333"},LineType:{Type:[String,Boolean],default:!0},PriceTxt:{Type:String,default:"99.99"},PriceColor:{Type:String,default:"#e31d1a"},OriginalTxt:{Type:String,default:""},OriginalColor:{Type:String,default:"#b8b8b8"},Width:{Type:String,default:720},CanvasBg:{Type:String,default:"#ffffff"},Referrer:{Type:String,default:"quitter推荐给你"},ViewDetails:{Type:String,default:"长按分享或扫描识别二维码"}},data:function(){return{canvasW:0,canvasH:0,canvasImgSrc:"",ctx:null}},methods:{OnCanvas:function(){var e=o(c.default.mark(function e(){var a,n,i,o,l,s,u,x,f,p,d,T,g,h,v,m,S,w,y,b;return c.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=this,r.imgSrc=this.$store.state.posterSrc,r.avatarUrl=this.$store.state.userInfo.avatarUrl,r.QrSrc=this.$store.state.qrSrc,r.ctx=t.createCanvasContext(r.CanvasID,this),a=t.upx2px(r.Width),n=t.upx2px(30),i=t.upx2px(150),o=0,e.next=9,r.getImageInfo({imgSrc:r.imgSrc});case 9:return l=e.sent,e.next=12,r.getImageInfo({imgSrc:r.avatarUrl});case 12:return s=e.sent,e.next=15,r.getImageInfo({imgSrc:r.QrSrc});case 15:u=e.sent,x=[l.width,l.height],f=[s.width,s.height],p=[u.width,u.height],d=a-2*n,x[0]!=d&&(x[1]=Math.floor(d/x[0]*x[1]),x[0]=d),f[0]!=i&&(f[1]=Math.floor(i/f[0]*f[1]),f[0]=i),p[0]!=i&&(p[1]=Math.floor(i/p[0]*p[1]),p[0]=i),r.canvasW=a,r.canvasH=x[1]+p[1]+128,T=0,g=0,h=a,v=r.canvasH,m=8,r.ctx.beginPath(),r.ctx.moveTo(T+m,g),r.ctx.arcTo(T+h,g,T+h,g+v,m),r.ctx.arcTo(T+h,g+v,T,g+v,m),r.ctx.arcTo(T,g+v,T,g,m),r.ctx.arcTo(T,g,T+h,g,m),r.ctx.closePath(),r.ctx.clip(),r.ctx.setFillStyle(r.CanvasBg),r.ctx.fillRect(0,0,a,r.canvasH),r.ctx.setFontSize(t.upx2px(24)),r.ctx.setFillStyle(r.TitleColor),S=0,w=x[1]+2*n+10,y=1,b=0;case 42:if(!(b<r.Title.length)){e.next=64;break}if(o+=r.ctx.measureText(r.Title[b]).width,!(o>x[0])){e.next=60;break}if(2!=y||!r.LineType){e.next=53;break}return r.ctx.fillText(r.Title.substring(S,b-8)+"...",n,w),o=0,S=b,y++,e.abrupt("break",64);case 53:r.ctx.fillText(r.Title.substring(S,b),n,w),o=0,w+=20,S=b,y++;case 58:e.next=61;break;case 60:b==r.Title.length-1&&(r.ctx.fillText(r.Title.substring(S,b+1),n,w),o=0);case 61:b++,e.next=42;break;case 64:o=n,w+=t.upx2px(60),1==y&&(w+=36),""!=r.PriceTxt&&(r.ctx.setFillStyle(r.PriceColor),r.ctx.setFontSize(t.upx2px(33)),r.ctx.fillText(r.PriceTxt,o,w),o+=r.ctx.measureText(r.PriceTxt).width+t.upx2px(10)),""!=r.PriceTxt&&""!=r.OriginalTxt&&(r.ctx.setFillStyle(r.OriginalColor),r.ctx.setFontSize(t.upx2px(24)),r.ctx.fillText(r.OriginalTxt,o,w)),r.ctx.strokeStyle=r.OriginalColor,r.ctx.moveTo(o,w-t.upx2px(10)),r.ctx.lineTo(o+r.ctx.measureText(r.OriginalTxt).width,w-t.upx2px(10)),r.ctx.stroke(),w+=t.upx2px(20),r.ctx.drawImage(u.path,x[0]-p[0]+n,w,p[0],p[1]),r.ctx.setFillStyle(r.TitleColor),r.ctx.setFontSize(t.upx2px(28)),r.ctx.fillText(r.Referrer,n+.9*f[0],w+p[1]/2+13),r.ctx.setFillStyle(r.OriginalColor),r.ctx.setFontSize(t.upx2px(28)),r.ctx.fillText(r.ViewDetails,n+.9*f[0],w+p[1]/2+33),r.ctx.save(),T=n,g=n,h=x[0],v=x[1],m=5,r.ctx.beginPath(),r.ctx.moveTo(T+m,g),r.ctx.arcTo(T+h,g,T+h,g+v,m),r.ctx.arcTo(T+h,g+v,T,g+v,m),r.ctx.arcTo(T,g+v,T,g,m),r.ctx.arcTo(T,g,T+h,g,m),r.ctx.closePath(),r.ctx.shadowColor="#cdcdcd",r.ctx.shadowBlur=4,r.ctx.shadowOffsetX=3,r.ctx.shadowOffsetY=5,r.ctx.fill(),r.ctx.clip(),r.ctx.drawImage(l.path,n,n,x[0],x[1]),r.ctx.restore(),T=n,g=w+14,h=.8*f[0],v=.8*f[1],m=5,r.ctx.save(),r.ctx.beginPath(),r.ctx.moveTo(T+m,g),r.ctx.arcTo(T+h,g,T+h,g+v,m),r.ctx.arcTo(T+h,g+v,T,g+v,m),r.ctx.arcTo(T,g+v,T,g,m),r.ctx.arcTo(T,g,T+h,g,m),r.ctx.closePath(),r.ctx.shadowColor="#cdcdcd",r.ctx.shadowBlur=4,r.ctx.shadowOffsetX=3,r.ctx.shadowOffsetY=5,r.ctx.fill(),r.ctx.clip(),r.ctx.drawImage(s.path,n,w+14,.8*f[0],.8*f[1]),r.ctx.restore(),r.ctx.draw(!0,function(t){r.$emit("hideLoading"),setTimeout(function(){r.getNewImage()},200)});case 116:case"end":return e.stop()}},e,this)}));function a(){return e.apply(this,arguments)}return a}(),getImageInfo:function(){var e=o(c.default.mark(function e(a){var r;return c.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=a.imgSrc,e.abrupt("return",new Promise(function(e,a){t.getImageInfo({src:r,success:function(t){e(t)},fail:function(t){a(t)}})}));case 2:case"end":return e.stop()}},e,this)}));function a(t){return e.apply(this,arguments)}return a}(),getNewImage:function(){t.canvasToTempFilePath({canvasId:r.CanvasID,quality:1,success:function(t){r.$emit("success",t)}},this)}}};e.default=l}).call(this,a("6e42")["default"])},fcca:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement;t._self._c},c=[];a.d(e,"a",function(){return r}),a.d(e,"b",function(){return c})}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'pages/component/wm-poster-create-component',
    {
        'pages/component/wm-poster-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('6e42')['createComponent'](__webpack_require__("1367"))
        })
    },
    [['pages/component/wm-poster-create-component']]
]);                
