(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/component/wm-poster"],{1367:function(t,e,r){"use strict";r.r(e);var a=r("1dbb"),c=r("85f0");for(var n in c)"default"!==n&&function(t){r.d(e,t,function(){return c[t]})}(n);var i=r("2877"),l=Object(i["a"])(c["default"],a["a"],a["b"],!1,null,null,null);e["default"]=l.exports},"1dbb":function(t,e,r){"use strict";var a=function(){var t=this,e=t.$createElement;t._self._c},c=[];r.d(e,"a",function(){return a}),r.d(e,"b",function(){return c})},"85f0":function(t,e,r){"use strict";r.r(e);var a=r("c480"),c=r.n(a);for(var n in a)"default"!==n&&function(t){r.d(e,t,function(){return a[t]})}(n);e["default"]=c.a},c480:function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a,c=n(r("a34a"));function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e,r,a,c,n,i){try{var l=t[n](i),o=l.value}catch(s){return void r(s)}l.done?e(o):Promise.resolve(o).then(a,c)}function l(t){return function(){var e=this,r=arguments;return new Promise(function(a,c){var n=t.apply(e,r);function l(t){i(n,a,c,l,o,"next",t)}function o(t){i(n,a,c,l,o,"throw",t)}l(void 0)})}}var o={name:"wm-poster",props:{CanvasID:{Type:String,default:"PosterCanvas"},imgSrc:{Type:String,default:""},avatarUrl:{Type:String,default:""},QrSrc:{Type:String,default:""},Title:{Type:String,default:""},TitleColor:{Type:String,default:"#333333"},LineType:{Type:[String,Boolean],default:!0},PriceTxt:{Type:String,default:"99.99"},PriceColor:{Type:String,default:"#e31d1a"},OriginalTxt:{Type:String,default:""},OriginalColor:{Type:String,default:"#b8b8b8"},Width:{Type:String,default:720},CanvasBg:{Type:String,default:"#ffffff"},Referrer:{Type:String,default:"quitter推荐给你"},ViewDetails:{Type:String,default:"长按分享或扫码购买"}},data:function(){return{canvasW:0,canvasH:0,canvasImgSrc:"",ctx:null}},methods:{OnCanvas:function(){var e=l(c.default.mark(function e(){var r,n,i,l,o,s,u,x,f,d,p,g,T,h,v,S,m,w,y,b;return c.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=this,a.imgSrc=this.$store.state.posterSrc,a.avatarUrl=this.$store.state.userInfo.avatarUrl,a.QrSrc=this.$store.state.qrSrc,a.ctx=t.createCanvasContext(a.CanvasID,this),r=t.upx2px(a.Width),n=t.upx2px(30),i=t.upx2px(150),l=0,e.next=9,a.getImageInfo({imgSrc:a.imgSrc});case 9:return o=e.sent,e.next=12,a.getImageInfo({imgSrc:a.avatarUrl});case 12:return s=e.sent,e.next=15,a.getImageInfo({imgSrc:a.QrSrc});case 15:u=e.sent,x=[o.width,o.height],f=[s.width,s.height],d=[u.width,u.height],p=r-2*n,x[0]!=p&&(x[1]=Math.floor(p/x[0]*x[1]),x[0]=p),f[0]!=i&&(f[1]=Math.floor(i/f[0]*f[1]),f[0]=i),d[0]!=i&&(d[1]=Math.floor(i/d[0]*d[1]),d[0]=i),a.canvasW=r,a.canvasH=x[1]+d[1]+100,a.ctx.setFillStyle(a.CanvasBg),a.ctx.fillRect(0,0,r,a.canvasH),a.ctx.setFontSize(t.upx2px(28)),a.ctx.setFillStyle(a.TitleColor),g=0,T=x[1]+2*n-5,h=1,v=0;case 33:if(!(v<a.Title.length)){e.next=55;break}if(l+=a.ctx.measureText(a.Title[v]).width,!(l>x[0]-20)){e.next=51;break}if(2!=h||!a.LineType){e.next=44;break}return a.ctx.fillText(a.Title.substring(g,v-3)+"...",n+10,T),l=0,g=v,h++,e.abrupt("break",55);case 44:a.ctx.fillText(a.Title.substring(g,v),n+10,T),l=0,T+=20,g=v,h++;case 49:e.next=52;break;case 51:v==a.Title.length-1&&(a.ctx.fillText(a.Title.substring(g,v+1),n+10,T),l=0);case 52:v++,e.next=33;break;case 55:l=n,T+=t.upx2px(60),1==h&&(T+=36),""!=a.PriceTxt&&(a.ctx.setFillStyle(a.PriceColor),a.ctx.setFontSize(t.upx2px(33)),a.ctx.fillText(a.PriceTxt,l+10,T-3),l+=a.ctx.measureText(a.PriceTxt).width+t.upx2px(10)),""!=a.PriceTxt&&""!=a.OriginalTxt&&(a.ctx.setFillStyle(a.OriginalColor),a.ctx.setFontSize(t.upx2px(24)),a.ctx.fillText(a.OriginalTxt,l,T)),a.ctx.strokeStyle=a.OriginalColor,a.ctx.moveTo(l,T-t.upx2px(10)),a.ctx.lineTo(l+a.ctx.measureText(a.OriginalTxt).width,T-t.upx2px(10)),a.ctx.stroke(),T+=t.upx2px(20),a.ctx.drawImage(u.path,x[0]-d[0]+n-5,T-13,d[0],d[1]),a.ctx.setFillStyle(a.TitleColor),a.ctx.setFontSize(t.upx2px(28)),a.ctx.fillText(a.Referrer,n+.9*f[0]+10,T+d[1]/2-10),a.ctx.setFillStyle(a.OriginalColor),a.ctx.setFontSize(t.upx2px(28)),a.ctx.fillText(a.ViewDetails,n+.9*f[0]+10,T+d[1]/2+10),a.ctx.save(),S=n,m=n-13,w=x[0],y=x[1],b=5,a.ctx.beginPath(),a.ctx.moveTo(S+b,m),a.ctx.arcTo(S+w,m,S+w,m+y,b),a.ctx.arcTo(S+w,m+y,S,m+y,b),a.ctx.arcTo(S,m+y,S,m,b),a.ctx.arcTo(S,m,S+w,m,b),a.ctx.closePath(),a.ctx.shadowColor="#cdcdcd",a.ctx.shadowBlur=4,a.ctx.shadowOffsetX=3,a.ctx.shadowOffsetY=5,a.ctx.fill(),a.ctx.clip(),a.ctx.drawImage(o.path,n,n,x[0],x[1]),a.ctx.restore(),S=n+10,m=T-2,w=.8*f[0],y=.8*f[1],b=5,a.ctx.save(),a.ctx.beginPath(),a.ctx.moveTo(S+b,m),a.ctx.arcTo(S+w,m,S+w,m+y,b),a.ctx.arcTo(S+w,m+y,S,m+y,b),a.ctx.arcTo(S,m+y,S,m,b),a.ctx.arcTo(S,m,S+w,m,b),a.ctx.closePath(),a.ctx.shadowColor="#cdcdcd",a.ctx.shadowBlur=4,a.ctx.shadowOffsetX=3,a.ctx.shadowOffsetY=5,a.ctx.fill(),a.ctx.clip(),a.ctx.drawImage(s.path,S,m,.8*f[0],.8*f[1]),a.ctx.restore(),a.ctx.lineWidth=3,a.ctx.strokeStyle="#FFFFFF",a.ctx.strokeRect(n,n,r-2*n,a.canvasH-2*n),a.ctx.clearRect,a.ctx.lineWidth=30,a.ctx.strokeRect(0,0,r,a.canvasH),a.ctx.draw(!0,function(t){a.$emit("hideLoading"),setTimeout(function(){a.getNewImage()},200)});case 113:case"end":return e.stop()}},e,this)}));function r(){return e.apply(this,arguments)}return r}(),getImageInfo:function(){var e=l(c.default.mark(function e(r){var a;return c.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=r.imgSrc,e.abrupt("return",new Promise(function(e,r){t.getImageInfo({src:a,success:function(t){e(t)},fail:function(t){r(t)}})}));case 2:case"end":return e.stop()}},e,this)}));function r(t){return e.apply(this,arguments)}return r}(),getNewImage:function(){t.canvasToTempFilePath({canvasId:a.CanvasID,quality:1,success:function(t){a.$emit("success",t)}},this)}}};e.default=o}).call(this,r("543d")["default"])}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'pages/component/wm-poster-create-component',
    {
        'pages/component/wm-poster-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("1367"))
        })
    },
    [['pages/component/wm-poster-create-component']]
]);                
