(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/activity/component/pageList"],{"0e3f":function(t,i,e){},1895:function(t,i,e){"use strict";(function(t){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var e=1,n={data:function(){return{isDisabled:"",clientHeight:"",firstStep:!0,avatarUrl:this.$store.state.userInfo.avatarUrl,customTheme:"",activeList:[{name:"课程选择"},{name:"礼品"},{name:"信息补充"},{name:"完成"}],active:-1,slideAction:"",giftList:[],scrollLeft:0,tabCurrentIndex:0,swiperCurrentIndex:0,institutionList:[{name:"全部",items:[]}],itemList:[],activity_id:"",form:{activity_id:"",student_name:"",student_age:"",phone:"",items:[],gifts:[]},giftSelectDetail:[],itemSelectDetail:[],page0:1,page1:1,page2:1}},onLoad:function(t){this.activity_id=t.id,this.form.activity_id=t.id,this.customTheme=this.$store.state.customTheme,this.getgiftList(),this.getItemList(),this.getInstitutionList()},methods:{scrolltoBottom:function(t){e&&0===this.tabCurrentIndex&&(e=0,this.getItemList(),setTimeout(function(){e=1},1e3))},scrolltoRight:function(t){e&&(e=0,this.getInstitutionList(),setTimeout(function(){e=1},1e3))},giftSelectCheck:function(t,i){if(i.check=!i.check,i.check)this.giftSelectDetail.push(i),this.form.gifts.push(i.gift_id);else{var e=this.form.gifts.indexOf(i.gift_id);this.giftSelectDetail.splice(e,1),this.form.gifts.splice(e,1)}},itemSelectCheck:function(i,e,n,o){var a=this.form.items.indexOf(o.item_id);if(-1===a){if(this.form.items.length===this.$store.state.temp)return void t.showModal({title:"提示",content:"最多只能选择"+this.$store.state.temp+"门课程",showCancel:!1,confirmText:"知道了"});if(e.img_url&&(o.institution_img_url=e.img_url),this.itemSelectDetail.findIndex(function(t){return t.institution_img_url===o.institution_img_url})>=0)return void t.showModal({title:"提示",content:"同个机构下只能选择1门课程",showCancel:!1,confirmText:"知道了"});this.itemSelectDetail.push(o),this.form.items.push(o.item_id)}else this.itemSelectDetail.splice(a,1),this.form.items.splice(a,1)},tabSelect:function(t){var i=t.currentTarget.dataset.id;this.swiperCurrentIndex=i,this.tabCurrentIndex=i},swiperChange:function(t){var i=t.detail.current;this.scrollLeft=60*i,this.tabCurrentIndex=i,this.swiperCurrentIndex=i,console.log(this.scrollLeft)},getgiftList:function(t){var i=this;this.$http({url:"/activity/".concat(this.activity_id,"/gifts/").concat(this.page2),v2:!0}).then(function(t){i.giftList=t;var e=!0,n=!1,o=void 0;try{for(var a,s=i.giftList[Symbol.iterator]();!(e=(a=s.next()).done);e=!0){var r=a.value;i.$set(r,"check",!1)}}catch(c){n=!0,o=c}finally{try{e||null==s.return||s.return()}finally{if(n)throw o}}})},getItemList:function(){var t=this;this.$http({url:"/activity/".concat(this.activity_id,"/items/").concat(this.page1)}).then(function(i){if(t.page1<2){t.institutionList[0].items=i;var e=!0,n=!1,o=void 0;try{for(var a,s=t.institutionList[0].items[Symbol.iterator]();!(e=(a=s.next()).done);e=!0){var r=a.value;t.$set(r,"check",!1)}}catch(d){n=!0,o=d}finally{try{e||null==s.return||s.return()}finally{if(n)throw o}}}else{var c=!0,u=!1,l=void 0;try{for(var f,h=i[Symbol.iterator]();!(c=(f=h.next()).done);c=!0){var m=f.value;t.$set(m,"check",!1),t.institutionList[0].items.push(m)}}catch(d){u=!0,l=d}finally{try{c||null==h.return||h.return()}finally{if(u)throw l}}}t.page1+=1})},getInstitutionList:function(){var i=this;this.$http({url:"/activity/".concat(this.activity_id,"/institutions/").concat(this.page0,"/withItems"),v2:!0}).then(function(e){var n=!0,o=!1,a=void 0;try{for(var s,r=e[Symbol.iterator]();!(n=(s=r.next()).done);n=!0){var c=s.value,u=!0,l=!1,f=void 0;try{for(var h,m=c.items[Symbol.iterator]();!(u=(h=m.next()).done);u=!0){var d=h.value;d.check=!1}}catch(v){l=!0,f=v}finally{try{u||null==m.return||m.return()}finally{if(l)throw f}}i.institutionList.push(c)}}catch(v){o=!0,a=v}finally{try{n||null==r.return||r.return()}finally{if(o)throw a}}i.page0+=1,t.getSystemInfo({success:function(t){i.clientHeight=t.windowHeight-190}})})},itemJump:function(i,e){2==this.type?t.navigateTo({url:"../home/item?id=".concat(e,"&order_id=").concat(this.list[i].order_id),animationType:"pop-in",animationDuration:200}):t.navigateTo({url:"../home/item?id=".concat(e),animationType:"pop-in",animationDuration:200})},lastStep:function(){var i=this;-1===this.active&&t.navigateBack(),this.slideAction="slide-back",setTimeout(function(){i.active=i.active==i.activeList.length-1?0:i.active-1,i.slideAction="fade-in"},350)},nextStep:function(){var i=this;if(console.log(e),e){if(e=0,setTimeout(function(){e=1,console.log(e,"okay")},1e3),-1===this.active&&this.form.items.length<1)return void t.showModal({title:"提示",content:"请至少选择1门课程",showCancel:!1,confirmText:"知道了"});if(1===this.active&&(!this.form.student_name||!this.form.student_age||!this.form.phone))return void t.showModal({title:"提示",content:"请完善信息，以方便我们与您联系",showCancel:!1,confirmText:"知道了"});if(1===this.active&&11!==this.form.phone.length&&"number"===typeof(1*this.form.phone))return void t.showModal({title:"提示",content:"联系电话格式不正确，请再次核对",showCancel:!1,confirmText:"知道了"});if(2===this.active)return void this.pay();this.slideAction="slide-next",setTimeout(function(){i.active=i.active==i.activeList.length-1?0:i.active+1,i.slideAction="fade-in"},350)}},pay:function(){var i=this;function e(e){t.requestPayment({provider:"wxpay",timeStamp:e.timeStamp,nonceStr:e.nonceStr,package:e.package,signType:"MD5",paySign:e.paySign,success:function(t){i.$http({url:"/activity_order/"+e.out_trade_no+"/message",loading:"none",alert:"none"}),i.slideAction="slide-next",setTimeout(function(){i.active=i.active==i.activeList.length-1?0:i.active+1,i.slideAction="fade-in"},350)}})}this.$store.state.extra&&(this.form.extra=this.$store.state.extra.split("&")[1]),console.log(this.$store.state.extra),this.$http({url:"/activity_order",v3:!0,method:"POST",data:this.form,loading:"none"}).then(function(t){e(t)})},home:function(){t.reLaunch({url:"/pages/index/index"})},back:function(){t.navigateBack()}}};i.default=n}).call(this,e("543d")["default"])},"3cbc":function(t,i,e){"use strict";e.r(i);var n=e("1895"),o=e.n(n);for(var a in n)"default"!==a&&function(t){e.d(i,t,function(){return n[t]})}(a);i["default"]=o.a},"41f1":function(t,i,e){"use strict";var n=function(){var t=this,i=t.$createElement,e=(t._self._c,t.__map(t.institutionList,function(i,e){var n=t.__map(i.items,function(i,e){var n=t.form.items.indexOf(i.item_id);return{$orig:t.__get_orig(i),g0:n}}),o=t.__map(i.items,function(i,e){var n=t.form.items.indexOf(i.item_id);return{$orig:t.__get_orig(i),g1:n}});return{$orig:t.__get_orig(i),l0:n,l1:o}}));t.$mp.data=Object.assign({},{$root:{l2:e}})},o=[];e.d(i,"a",function(){return n}),e.d(i,"b",function(){return o})},"9eb5":function(t,i,e){"use strict";(function(t){e("1f93"),e("921b");n(e("66fd"));var i=n(e("db30"));function n(t){return t&&t.__esModule?t:{default:t}}t(i.default)}).call(this,e("543d")["createPage"])},a14a:function(t,i,e){"use strict";var n=e("0e3f"),o=e.n(n);o.a},db30:function(t,i,e){"use strict";e.r(i);var n=e("41f1"),o=e("3cbc");for(var a in o)"default"!==a&&function(t){e.d(i,t,function(){return o[t]})}(a);e("a14a");var s=e("2877"),r=Object(s["a"])(o["default"],n["a"],n["b"],!1,null,"cffd43f8",null);i["default"]=r.exports}},[["9eb5","common/runtime","common/vendor"]]]);